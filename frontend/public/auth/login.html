<!DOCTYPE html>
<html>
<head><title>Login</title></head>
<body>

<h2>Login</h2>
<input id="email" placeholder="Email" />
<input id="password" type="password" placeholder="Password" />
<button onclick="login()">Login</button>

<script type="module">
import { supabase } from '/supabase.js'

window.login = async () => {
  const email = email.value
  const password = password.value

  const { data, error } =
    await supabase.auth.signInWithPassword({ email, password })

  if (error) return alert(error.message)

  const { data: profile } = await supabase
    .from('profiles')
    .select('role')
    .eq('id', data.user.id)
    .single()

  if (profile.role === 'cleaner') location.href = '/cleaner/dashboard.html'
  if (profile.role === 'client') location.href = '/client/tracking.html'
  if (profile.role === 'admin') location.href = '/admin/dashboard.html'
}
</script>

</body>
</html>
